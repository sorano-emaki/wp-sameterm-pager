{"version":3,"file":"admin/admin.js","mappings":"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","sources":["webpack://wp-sameterm-pager/./src/admin/navigation.js","webpack://wp-sameterm-pager/./src/admin/admin.scss","webpack://wp-sameterm-pager/external window \"ReactJSXRuntime\"","webpack://wp-sameterm-pager/external window [\"wp\",\"apiFetch\"]","webpack://wp-sameterm-pager/external window [\"wp\",\"components\"]","webpack://wp-sameterm-pager/external window [\"wp\",\"element\"]","webpack://wp-sameterm-pager/webpack/bootstrap","webpack://wp-sameterm-pager/webpack/runtime/compat get default export","webpack://wp-sameterm-pager/webpack/runtime/define property getters","webpack://wp-sameterm-pager/webpack/runtime/hasOwnProperty shorthand","webpack://wp-sameterm-pager/webpack/runtime/make namespace object","webpack://wp-sameterm-pager/./src/admin/admin.js"],"sourcesContent":["import { useState, useEffect } from '@wordpress/element';\r\nconst PageNavigation = () => {\r\n    const [currentPage, setCurrentPage] = useState('');\r\n\r\n    useEffect(() => {\r\n        // 現在のページURLのクエリパラメータから現在のページを特定\r\n        const params = new URLSearchParams(window.location.search);\r\n        setCurrentPage(params.get('page'));\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"admin-sidebar\">\r\n            <h3>Same Term Pager 設定</h3>\r\n            <ul>\r\n                <li>\r\n                    <a\r\n                        href=\"admin.php?page=wp_sameterm_pager\"\r\n                        className={currentPage === 'wp_sameterm_pager' ? 'active' : ''}\r\n                    >\r\n                        一般設定\r\n                    </a>\r\n                </li>\r\n                <li>\r\n                    <a\r\n                        href=\"admin.php?page=wp_sameterm_pager_additional\"\r\n                        className={currentPage === 'wp_sameterm_pager_additional' ? 'active' : ''}\r\n                    >\r\n                        追加設定\r\n                    </a>\r\n                </li>\r\n                <li>\r\n                    <a\r\n                        href=\"admin.php?page=wp_sameterm_pager_help\"\r\n                        className={currentPage === 'wp_sameterm_pager_help' ? 'active' : ''}\r\n                    >\r\n                        ヘルプ\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PageNavigation;","// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"ReactJSXRuntime\"];","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// 設定画面用スタイル\r\nimport './admin.scss';\r\n\r\nimport { \r\n    render,\r\n    useState,\r\n    useEffect\r\n} from '@wordpress/element';\r\nimport {\r\n    ToggleControl,\r\n    TextControl,\r\n    Button,\r\n    Notice,\r\n    Spinner\r\n} from '@wordpress/components';\r\nimport apiFetch from '@wordpress/api-fetch';\r\nimport PageNavigation from './navigation';  // 共通ナビゲーションのインポート\r\n\r\nconst Admin = () => {\r\n    const [showPagerTop, setShowPagerTop] = useState(true);\r\n    const [showPagerBtm, setShowPagerBtm] = useState(true);\r\n    \r\n    // ローディング状態の管理\r\n    const [isLoading, setIsLoading] = useState(true); // 初期表示はローディング中\r\n\r\n    // ローディング状態、メッセージ状態の追加\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [statusMessage, setStatusMessage] = useState(null);\r\n    const [hasChanges, setHasChanges] = useState(false);    // 変更があったかどうかのフラグ\r\n    \r\n    \r\n    // 画面遷移時に保存確認ダイアログを追加\r\n    useEffect(() => {\r\n        const handleBeforeUnload = (event) => {\r\n            if (hasChanges) {\r\n                event.preventDefault();\r\n                event.returnValue = ''; // これを設定することで、確認ダイアログが表示される\r\n            }\r\n        };\r\n\r\n        window.addEventListener('beforeunload', handleBeforeUnload);\r\n\r\n        // クリーンアップ\r\n        return () => {\r\n            window.removeEventListener('beforeunload', handleBeforeUnload);\r\n        };\r\n    }, [hasChanges]);\r\n\r\n    // 初期設定を取得する処理    \r\n    useEffect(() => {\r\n        setIsLoading(true);\r\n        apiFetch({ path: '/wp/v2/settings' })\r\n            .then(response => {\r\n                setShowPagerTop(Boolean(response.smtrm_pager_top));\r\n                setShowPagerBtm(Boolean(response.smtrm_pager_bottom));\r\n            })\r\n            .catch(error => {\r\n                setStatusMessage({ type: 'error', text: '設定の取得に失敗しました。' });\r\n            })\r\n            .finally(() => {\r\n                // ローディング終了\r\n                setIsLoading(false);\r\n            });\r\n    }, []);\r\n\r\n    const onClick = async () => {\r\n    \r\n        // 保存確認ダイアログ\r\n        if (!window.confirm('本当に設定を保存しますか？')) {\r\n            return;\r\n        }\r\n    \r\n        setIsSaving(true);\r\n        setStatusMessage(null);\r\n    \r\n        try {\r\n            const response = await apiFetch({\r\n                path: '/wp/v2/settings',\r\n                method: 'POST',\r\n                data: {\r\n                    'smtrm_pager_top': showPagerTop,\r\n                    'smtrm_pager_bottom': showPagerBtm,                },\r\n                headers: {\r\n                    'X-WP-Nonce': smtrmPagerAdmin.nonce // nonceを使用\r\n                }\r\n            });\r\n    \r\n            setStatusMessage({ type: 'success', text: '設定が保存されました！' });\r\n            setHasChanges(false);  // 変更フラグをリセット\r\n        } catch (error) {\r\n            const errorMessage = error.message || '不明なエラーが発生しました。';\r\n            setStatusMessage({ type: 'error', text: `保存に失敗しました: ${errorMessage}` });\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    // ローディング中であればSpinnerを表示\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"smtrm-admin-loading\">\r\n                <Spinner className=\"custom-spinner\" /> {/* ローディングインジケーター */}\r\n                <p>設定を読み込んでいます...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"smtrm-admin-wrapper\">\r\n            <div className=\"admin-content\">\r\n                <h1>Same Term Pager 設定</h1>\r\n                {/* 保存成功/失敗メッセージの表示 */}\r\n                {statusMessage && (\r\n                    <Notice\r\n                        status={statusMessage.type}\r\n                        onRemove={() => setStatusMessage(null)}\r\n                    >\r\n                        {statusMessage.text}\r\n                    </Notice>\r\n                )}\r\n                <h2>一般設定</h2>\r\n                <div className=\"setting-wrapper\">\r\n                    <div className=\"setting-box\">\r\n                        <h3>投稿上下のページャー</h3>\r\n                        <ToggleControl\r\n                            label=\"投稿上に表示する\"\r\n                            checked={showPagerTop}\r\n                            onChange={() => {\r\n                                setShowPagerTop(!showPagerTop);\r\n                                setHasChanges(true);  // 変更があったことを通知\r\n                            }}\r\n                        />\r\n                        <ToggleControl\r\n                            label=\"投稿下に表示する\"\r\n                            checked={showPagerBtm}\r\n                            onChange={() => {\r\n                                setShowPagerBtm(!showPagerBtm);\r\n                                setHasChanges(true);  // 変更があったことを通知\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <Button\r\n                    isPrimary\r\n                    onClick={onClick}\r\n                    disabled={isSaving}\r\n                >\r\n                    {isSaving ? (\r\n                        <>\r\n                            <Spinner /> 保存中…\r\n                        </>\r\n                    ) : (\r\n                        '保存'\r\n                    )}\r\n                </Button>\r\n            </div>\r\n            {/* 右カラム（ナビゲーション） */}\r\n            <PageNavigation />\r\n        </div>\r\n    );\r\n};\r\n\r\n// AdminコンポーネントをルートDOMにレンダリング\r\nrender(\r\n    <Admin />,\r\n    document.getElementById('smtrm-pager-admin')\r\n);\r\n"],"names":["useState","useEffect","jsx","_jsx","jsxs","_jsxs","PageNavigation","currentPage","setCurrentPage","params","URLSearchParams","window","location","search","get","className","children","href","render","ToggleControl","TextControl","Button","Notice","Spinner","apiFetch","Fragment","_Fragment","Admin","showPagerTop","setShowPagerTop","showPagerBtm","setShowPagerBtm","isLoading","setIsLoading","isSaving","setIsSaving","statusMessage","setStatusMessage","hasChanges","setHasChanges","handleBeforeUnload","event","preventDefault","returnValue","addEventListener","removeEventListener","path","then","response","Boolean","smtrm_pager_top","smtrm_pager_bottom","catch","error","type","text","finally","onClick","confirm","method","data","headers","smtrmPagerAdmin","nonce","errorMessage","message","status","onRemove","label","checked","onChange","isPrimary","disabled","document","getElementById"],"sourceRoot":""}