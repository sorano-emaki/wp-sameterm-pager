(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,r=window.wp.components,n=window.wp.apiFetch;var s=e.n(n);const a=window.ReactJSXRuntime,o=()=>{const[e,n]=(0,t.useState)(!0),[o,l]=(0,t.useState)(!0),[c,m]=(0,t.useState)(""),[i,d]=(0,t.useState)(!0),[p,h]=(0,t.useState)(!1),[u,g]=(0,t.useState)(null);return(0,t.useEffect)((()=>{d(!0),s()({path:"/wp/v2/settings"}).then((e=>{n(Boolean(e.smtrm_pager_top)),l(Boolean(e.smtrm_pager_bottom)),m(e.smtrm_pager_entry_form)})).catch((e=>{g({type:"error",text:"設定の取得に失敗しました。"})})).finally((()=>{d(!1)}))}),[]),i?(0,a.jsxs)("div",{className:"smtrm-admin-loading",children:[(0,a.jsx)(r.Spinner,{className:"custom-spinner"})," ",(0,a.jsx)("p",{children:"設定を読み込んでいます..."})]}):(0,a.jsxs)("div",{className:"smtrm-admin-wrapper",children:[(0,a.jsx)("h1",{children:"Same Term Pager 設定"}),u&&(0,a.jsx)(r.Notice,{status:u.type,onRemove:()=>g(null),children:u.text}),(0,a.jsx)("h2",{children:"投稿上下のページャー"}),(0,a.jsx)(r.ToggleControl,{label:"投稿上に表示する",checked:e,onChange:()=>n(!e)}),(0,a.jsx)(r.ToggleControl,{label:"投稿下に表示する",checked:o,onChange:()=>l(!o)}),(0,a.jsx)("h2",{children:"追加設定"}),(0,a.jsx)(r.TextControl,{label:"絞り込み機能が動作しない場合に使用するCSSセレクタ (カンマ区切りで複数指定可能)",value:c,onChange:e=>m(e),placeholder:"例: class1, class2, class3"}),(0,a.jsx)(r.Button,{isPrimary:!0,onClick:async()=>{if(c){const e=/^[a-zA-Z0-9_\-#.,: \[\]="']+$/,t=c.split(",");for(let r of t)if(r=r.trim(),!e.test(r))return void g({type:"error",text:"無効なCSSセレクタがあります。セレクタには英字、数字、ID、クラス、属性セレクタ、擬似クラスが使用可能です。"})}if(window.confirm("本当に設定を保存しますか？")){h(!0),g(null);try{await s()({path:"/wp/v2/settings",method:"POST",data:{smtrm_pager_top:e,smtrm_pager_bottom:o,smtrm_pager_entry_form:c},headers:{"X-WP-Nonce":smtrmPagerAdmin.nonce}}),g({type:"success",text:"設定が保存されました！"})}catch(e){const t=e.message||"不明なエラーが発生しました。";g({type:"error",text:`保存に失敗しました: ${t}`})}finally{h(!1)}}},disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Spinner,{})," 保存中…"]}):"保存"})]})};(0,t.render)((0,a.jsx)(o,{}),document.getElementById("smtrm-pager-admin"))})();